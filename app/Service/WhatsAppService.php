<?php
namespace App\Service;

use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Http;
use Illuminate\Http\Client\Response;

class WhatsAppService
{

    private $phone;
    private $chatId;
    private $instancia;

    public function __construct($phone)
    {
        $this->phone = "51" . $phone;
        $this->instancia = (new InstanciaService())->instanciaDisponible();
    }

    public function setChatId($chatId){
        $this->chatId = $chatId;
    }

    public function sendResultadoImage($path, $texto) {

        $data = [
            "body" => COVID_URL . '/' . $path . 'resultado.jpg',
            "filename" => "resultado.jpg",
            "phone"=> $this->phone,
            "caption" => $texto
        ];
        return $this->sendRequest("File", $data);
    }

    public function sendMessageByChatId($text) {
        $data = [
            "body" => $text,
            "chatId" => $this->chatId
        ];
        $this->sendRequest('Message', $data);
    }

    public function sendMessage($text) {
        $data = [
            "phone" => $this->phone,
            "body" => $text
        ];
        return $this->sendRequest('Message', $data);
    }

    public function sendConstanciasLink() {
        $data = [
            "previewBase64" =>  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAAB+CAYAAAC3boSTAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA7VpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wUmlnaHRzPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvcmlnaHRzLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcFJpZ2h0czpNYXJrZWQ9IkZhbHNlIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6Rjc3RjExNzQwNzIwNjgxMTgwODNFQjgzQzYyQkQ3QzEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkYwQkRDQkM1MEFEMTFFNEJEQTY5QzNEQ0RBRjZDMkIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkYwQkRDQkI1MEFEMTFFNEJEQTY5QzNEQ0RBRjZDMkIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpENDNCRDkxRjEzMjA2ODExOEY2MkQ5MTNFMEI4MTIz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",
            "title"=> "CONSTANCIAS",
            "phone"=> $this->phone,
            "body"=> CONSTANCIAS_URL,
            "description"=> "INTERNATIONAL SOS"
        ];
        $this->sendRequest('Link', $data);
    }

    public function sendEvidenciasLink() {
        $data = [
            "previewBase64" =>  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAAB+CAYAAAC3boSTAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA7VpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wUmlnaHRzPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvcmlnaHRzLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcFJpZ2h0czpNYXJrZWQ9IkZhbHNlIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6Rjc3RjExNzQwNzIwNjgxMTgwODNFQjgzQzYyQkQ3QzEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkYwQkRDQkM1MEFEMTFFNEJEQTY5QzNEQ0RBRjZDMkIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkYwQkRDQkI1MEFEMTFFNEJEQTY5QzNEQ0RBRjZDMkIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpENDNCRDkxRjEzMjA2ODExOEY2MkQ5MTNFMEI4MTIz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",
            "title"=> "EVIDENCIAS",
            "phone"=> $this->phone,
            "body"=> EVIDENCIAS_URL,
            "description"=> "INTERNATIONAL SOS"
        ];
        $this->sendRequest('Link', $data);
    }

    public function sendManualEvidencias()  {
        $data = [
            "body" => COVID_URL . "/RC/manual.pdf",
            "filename" => "manual.pdf",
            "phone"=> $this->phone,
        ];
        $this->sendRequest('File', $data);
    }

    public function sendVideoEvidencias() {
        $data = [
            "body" => COVID_URL . "/RC/manualc.mp4",
            "filename" => "manualc.mp4",
            "phone"=> $this->phone,
        ];
        $this->sendRequest('File', $data);
    }

    private function sendRequest($method, $data) : array {
        $url = $this->instancia->url . 'send' . $method . '?token=' . $this->instancia->token;

        return [
            'request' => Http::post($url, $data)->json(),
            'instancia' => $this->instancia->id,
        ];
    }

    public function checkPhone() : Response {
        $data = [
            'token' => $this->instancia->token,
            'phone' => $this->phone
        ];
        $url = $this->instancia->url . 'checkPhone';
        return Http::get($url, $data);
    }

}